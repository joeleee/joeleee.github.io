

<!DOCTYPE html>
<html lang="null">
<head prefix="og: http://ogp.me/ns#">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1">
    <meta name="description" content="null">
    <title>In-App-Purcharse 摘要 | Joe&#39;s Doc</title>

    <!-- Open Graph -->
    <meta name="description" content="&amp;#x8FD9;&amp;#x5E76;&amp;#x4E0D;&amp;#x662F;&amp;#x4E00;&amp;#x7BC7;&amp;#x5173;&amp;#x4E8E; In-App-Purcharse &amp;#x7684;&amp;#x4E13;&amp;#x4E1A;&amp;#x6DF1;&amp;#x5165;&amp;#x5206;&amp;#x6790;&amp;#x6587;&amp;#x7AE0;&amp;#xFF0C;&amp;#x53EA;&amp;#x662F;&amp;#x5728;&amp;#x521D;&amp;#x6B2">
<meta property="og:type" content="article">
<meta property="og:title" content="In-App-Purcharse 摘要">
<meta property="og:url" content="http://yoursite.com/2014/01/09/In-App-Purcharse 摘要/index.html">
<meta property="og:site_name" content="Joe's Doc">
<meta property="og:description" content="&amp;#x8FD9;&amp;#x5E76;&amp;#x4E0D;&amp;#x662F;&amp;#x4E00;&amp;#x7BC7;&amp;#x5173;&amp;#x4E8E; In-App-Purcharse &amp;#x7684;&amp;#x4E13;&amp;#x4E1A;&amp;#x6DF1;&amp;#x5165;&amp;#x5206;&amp;#x6790;&amp;#x6587;&amp;#x7AE0;&amp;#xFF0C;&amp;#x53EA;&amp;#x662F;&amp;#x5728;&amp;#x521D;&amp;#x6B2">
<meta property="og:updated_time" content="2017-02-28T16:34:37.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="In-App-Purcharse 摘要">
<meta name="twitter:description" content="&amp;#x8FD9;&amp;#x5E76;&amp;#x4E0D;&amp;#x662F;&amp;#x4E00;&amp;#x7BC7;&amp;#x5173;&amp;#x4E8E; In-App-Purcharse &amp;#x7684;&amp;#x4E13;&amp;#x4E1A;&amp;#x6DF1;&amp;#x5165;&amp;#x5206;&amp;#x6790;&amp;#x6587;&amp;#x7AE0;&amp;#xFF0C;&amp;#x53EA;&amp;#x662F;&amp;#x5728;&amp;#x521D;&amp;#x6B2">

    <script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Person",
  "email": "mailto:undefined",
  "image": "undefined",
  "name": "Joe Lee",
  "url": "http://yoursite.com"
}
</script>
    <script>
    var algoliaEnabled = false;
    
</script>

    

    
    
        <link href="https://fonts.gmirror.org/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
    
    
    
        <!-- stylesheets list from config.yml -->
        
        <link rel="stylesheet" href="/css/aloha.css">
        
        <link rel="stylesheet" href="//cdn.bootcss.com/semantic-ui/2.2.4/semantic.min.css">
        
        <link rel="stylesheet" href="//cdn.bootcss.com/magnific-popup.js/1.1.0/magnific-popup.min.css">
        
    

</head>
<body id="body" style="margin-bottom: 0;" class="pushable">

    <div class="ui top fixed menu">
        <a class="item" id="menu-icon"><i class="sidebar icon"></i></a>
    </div>

    <div id="menu-sidebar" class="ui left vertical sidebar menu">

    <div id="sidebar-top">
        <div class="content">
            <h3>Joe&#39;s Doc</h3>
        </div>
    </div>
    <div class="ui container sidebar-card">
    <div class="ui people shape content">
        <div class="active side">
            <div class="ui card">
                <div class="image">
                    <img class="ui medium bordered image" src="/images/me.jpg">
                </div>
                <div class="content">
                    <a class="header">Joe Lee</a>
                    
                        <div class="meta">
                            Developer/iOS/Basketball
                        </div>
                    
                </div>
                <div class="extra content">
                    <div class="ui list">
                        
                        <div class="item">
                            <i class="marker icon" style="float: left"></i>
                            <div class="content">Beijing</div>
                        </div>
                        
                        
                        <div class="item">
                            <i class="mail icon" style="float: left"></i>
                            <div class="content">
                                <a href="mailto:zhuocheng.lee@gmail.com">zhuocheng.lee@gmail.com</a>
                            </div>
                        </div>
                        
                    </div>

                </div>
                <div class="extra content">
                    <div class="ui list">
                        

                                <a href="https://github.com/joeleee"><i class="large github icon" style="float: left"></i></a>

                            

                                <a href="http://weibo.com/209093838?is_all=1"><i class="large weibo icon" style="float: left"></i></a>

                            
                    </div>
                </div>
            </div>
        </div>
    </div>


</div>

    
    

    

    
    <a href="/index.html" class="item" >
        <i class="home icon"></i>
        Home
    </a>

    

    
</div>

    <div class="pusher body-content">
        <div id="content" class="ui main container">
            <!--<div class="ui one column grid">-->
                <!--<div class="column">-->
                    <!--<div class="ui main container">-->
                        <div id="post-In-App-Purcharse 摘要" class="ui main container article-type-post">

    

    <div class="ui divided grid">

        <div class="two column row" id="article-content">

            <div class="thirteen wide computer thirteen wide tablet sixteen wide mobile column">
                

<h1 class="ui header">
    
    In-App-Purcharse 摘要
</h1>



                <div class="article-inner">

                    <div class="article-entry" itemprop="articleBody">
                        
                        <p>&#x8FD9;&#x5E76;&#x4E0D;&#x662F;&#x4E00;&#x7BC7;&#x5173;&#x4E8E; In-App-Purcharse &#x7684;&#x4E13;&#x4E1A;&#x6DF1;&#x5165;&#x5206;&#x6790;&#x6587;&#x7AE0;&#xFF0C;&#x53EA;&#x662F;&#x5728;&#x521D;&#x6B21;&#x6D4F;&#x89C8;&#x6709;&#x5173;IAP&#x5B98;&#x65B9;&#x6587;&#x6863;&#x540E;&#x8BB0;&#x5F55;&#x7684;&#x4E00;&#x4E9B;&#x9700;&#x8981;&#x6CE8;&#x610F;&#x7684;&#x5730;&#x65B9;&#xFF0C;&#x5C31;&#x50CF;&#x662F;&#x8BFE;&#x5802;&#x7B14;&#x8BB0;&#x3002;</p>
<p>&#x56E0;&#x4E3A;&#x8FD9;&#x662F;&#x539F;&#x7248;&#x3001;&#x5E76;&#x4E14;&#x6D89;&#x53CA;&#x5230;&#x652F;&#x4ED8;&#x7684;&#x5185;&#x5BB9;&#xFF0C;&#x6240;&#x4EE5;&#x5C31;&#x4E0D;&#x7FFB;&#x8BD1;&#xFF0C;&#x4EE5;&#x514D;&#x5F15;&#x8D77;&#x6B67;&#x4E49;&#xFF0C;&#x539F;&#x6587;&#x4F1A;&#x8BA9;&#x4F60;&#x66F4;&#x51C6;&#x786E;&#x7684;&#x7406;&#x89E3;&#x6587;&#x6863;&#x3002;</p>
<p>Updated by Joe Lee - 2014.1.9</p>
<hr>
<h1 id="&#x8D2D;&#x4E70;&#x4FE1;&#x606F;&#x6807;&#x8BC6;"><a href="#&#x8D2D;&#x4E70;&#x4FE1;&#x606F;&#x6807;&#x8BC6;" class="headerlink" title="&#x8D2D;&#x4E70;&#x4FE1;&#x606F;&#x6807;&#x8BC6;"></a>&#x8D2D;&#x4E70;&#x4FE1;&#x606F;&#x6807;&#x8BC6;</h1><p>To provide this information, populate the applicationUsername property of the payment object with a one-way hash of the user&#x2019;s account name on your server<br>only in iOS 7 &#xFF01;&#xFF01;</p>
<hr>
<h1 id="&#x7ED3;&#x675F;&#x8D2D;&#x4E70;"><a href="#&#x7ED3;&#x675F;&#x8D2D;&#x4E70;" class="headerlink" title="&#x7ED3;&#x675F;&#x8D2D;&#x4E70;"></a>&#x7ED3;&#x675F;&#x8D2D;&#x4E70;</h1><p>Finishing a transaction tells Store Kit that you&#x2019;ve completed everything needed for the purchase. Unfinished transactions remain in the queue until they&#x2019;re finished, and the transaction queue observer is called every time your app is launched so your app can finish the transactions.<br>Complete all of the following actions before you finish the transaction:<br>Persist the purchase.<br>Download associated content.</p>
<p>Update your app&#x2019;s UI to let the user access the product. </p>
<hr>
<h1 id="&#x4E0D;&#x8981;&#x8FD9;&#x6837;"><a href="#&#x4E0D;&#x8981;&#x8FD9;&#x6837;" class="headerlink" title="&#x4E0D;&#x8981;&#x8FD9;&#x6837;"></a>&#x4E0D;&#x8981;&#x8FD9;&#x6837;</h1><p>Don&#x2019;t try to call the finishTransaction: method before the transaction is actually completed, attempting to use some other mechanism in your app to track the transaction as unfinished. Store Kit isn&#x2019;t designed to be used this way. Doing so prevents your app from downloading Apple-hosted content and can lead to other issues. </p>
<p>After you finish a transaction, don&#x2019;t take any actions on that transaction or do any work to deliver the product. If any work remains, your app isn&#x2019;t ready to finish the transaction yet. </p>
<hr>
<h1 id="&#x8BA2;&#x9605;&#x65F6;&#x95F4;&#x7684;&#x8BA1;&#x7B97;"><a href="#&#x8BA2;&#x9605;&#x65F6;&#x95F4;&#x7684;&#x8BA1;&#x7B97;" class="headerlink" title="&#x8BA2;&#x9605;&#x65F6;&#x95F4;&#x7684;&#x8BA1;&#x7B97;"></a>&#x8BA2;&#x9605;&#x65F6;&#x95F4;&#x7684;&#x8BA1;&#x7B97;</h1><p> Don&#x2019;t calculate the subscription period by adding a subscription duration to the purchase date. This approach fails to take into account the free trial period, the marketing opt-in period, and the content made available immediately after the user purchased the subscription. </p>
<hr>
<h1 id="&#x81EA;&#x52A8;&#x7EED;&#x8BA2;&#x7684;&#x7B56;&#x7565;"><a href="#&#x81EA;&#x52A8;&#x7EED;&#x8BA2;&#x7684;&#x7B56;&#x7565;" class="headerlink" title="&#x81EA;&#x52A8;&#x7EED;&#x8BA2;&#x7684;&#x7B56;&#x7565;"></a>&#x81EA;&#x52A8;&#x7EED;&#x8BA2;&#x7684;&#x7B56;&#x7565;</h1><p>The App Store renews the subscription slightly before it expires, to prevent any lapse in the subscription. However, lapses are still possible. For example, if the user&#x2019;s payment information is no longer valid, the first renewal attempt would fail. If the user doesn&#x2019;t update this information until after the subscription expires, there would be a short lapse in the subscription between the expiration date and the date that a subsequent automatic renewal succeeds. The user can also disable automatic renewal and intentionally let the subscription expire, then renew it at a later date, creating a longer lapse in the subscription. Make sure your app&#x2019;s subscription logic can handle lapses of various durations correctly.</p>
<p>After a subscription is successfully renewed, Store Kit adds a transaction for the renewal to the transaction queue. Your app checks the transaction queue on launch and handles the renewal the same way as any other transaction. Note that if your app is already running when the subscription renews, the transaction observer is not called; your app finds out about the renewal the next time it&#x2019;s launched. </p>
<hr>
<h1 id="&#x53D6;&#x6D88;&#x8BA2;&#x9605;"><a href="#&#x53D6;&#x6D88;&#x8BA2;&#x9605;" class="headerlink" title="&#x53D6;&#x6D88;&#x8BA2;&#x9605;"></a>&#x53D6;&#x6D88;&#x8BA2;&#x9605;</h1><p>To check whether a purchase has been canceled, look for the Cancellation Date field in the receipt. If the field has a date in it, regardless of the subscription&#x2019;s expiration date, the purchase has been canceled&#x2014;treat a canceled receipt the same as if no purchase had ever been made.</p>
<p>Depending on the type of product, you may be able to check only the currently active subscription, or you may need to check all past subscriptions. For example, a magazine app would need to check all past subscriptions to determine which issues the user had access to. </p>
<hr>
<h1 id="&#x591A;&#x5E73;&#x53F0;&#x8D2D;&#x4E70;"><a href="#&#x591A;&#x5E73;&#x53F0;&#x8D2D;&#x4E70;" class="headerlink" title="&#x591A;&#x5E73;&#x53F0;&#x8D2D;&#x4E70;"></a>&#x591A;&#x5E73;&#x53F0;&#x8D2D;&#x4E70;</h1><p>Product identifiers are associated with a single app. Apps that have both an iOS and OS X version have separate products with separate product identifiers on each platform. You could let users who have a subscription in an iOS app access the content from an OS X app (or vice versa), but implementing that functionality is your responsibility. You would need some system for identifying users and keeping track of what content they&#x2019;ve subscribed to, similar to what you would implement for an app that uses non-renewable subscriptions.</p>
<hr>
<h1 id="&#x81EA;&#x52A8;&#x7EED;&#x8BA2;&#x6D4B;&#x8BD5;"><a href="#&#x81EA;&#x52A8;&#x7EED;&#x8BA2;&#x6D4B;&#x8BD5;" class="headerlink" title="&#x81EA;&#x52A8;&#x7EED;&#x8BA2;&#x6D4B;&#x8BD5;"></a>&#x81EA;&#x52A8;&#x7EED;&#x8BA2;&#x6D4B;&#x8BD5;</h1><p>For the sake of testing, there are some differences in behavior between auto-renewable subscriptions in the production environment and in the test environment.<br>Renewal happens at an accelerated rate, and auto-renewable subscriptions renew a maximum of six times per day. This lets you test how your app handles a subscription renewal, a subscription lapse, and a subscription history that includes gaps.<br>Because of the accelerated expiration and renewal rate, the subscription can expire before the system starts trying to renew the subscription, leaving a small lapse in the subscription period. Such lapses are also possible in production for a variety of reasons&#x2014;make sure your app handles them correctly.</p>
<hr>
<h1 id="&#x6062;&#x590D;&#x8D2D;&#x4E70;&#x9A8C;&#x8BC1;"><a href="#&#x6062;&#x590D;&#x8D2D;&#x4E70;&#x9A8C;&#x8BC1;" class="headerlink" title="&#x6062;&#x590D;&#x8D2D;&#x4E70;&#x9A8C;&#x8BC1;"></a>&#x6062;&#x590D;&#x8D2D;&#x4E70;&#x9A8C;&#x8BC1;</h1><p>Restoring purchases prompts for the user&#x2019;s App Store credentials, which interrupts the flow of your app: because of this, don&#x2019;t automatically restore purchases, especially not every time your app is launched. </p>
<hr>
<h1 id="&#x6062;&#x590D;receipt"><a href="#&#x6062;&#x590D;receipt" class="headerlink" title="&#x6062;&#x590D;receipt"></a>&#x6062;&#x590D;receipt</h1><p>in iOS 7, use initWithReceiptProperties: method of SKReceiptRefreshRequest.</p>
<p>if you need to support versions of iOS earlier than iOS 7, where the app receipt isn&#x2019;t available, restore completed transactions instead.</p>
<hr>
<h1 id="restore"><a href="#restore" class="headerlink" title="restore"></a>restore</h1><p>in iOS 7&#xFF0C;If your app sets a value for the applicationUsername property of its payment requests, as described in &#x201C;Detecting Irregular Activity,&#x201D; use therestoreCompletedTransactionsWithApplicationUsername: method to provide the same information when restoring transactions.</p>
<hr>
<h1 id="&#x521D;&#x6B21;&#x63D0;&#x4EA4;&#x5546;&#x54C1;"><a href="#&#x521D;&#x6B21;&#x63D0;&#x4EA4;&#x5546;&#x54C1;" class="headerlink" title="&#x521D;&#x6B21;&#x63D0;&#x4EA4;&#x5546;&#x54C1;"></a>&#x521D;&#x6B21;&#x63D0;&#x4EA4;&#x5546;&#x54C1;</h1><p>The first time you submit your app for review, you also need to submit in-app products to be reviewed at the same time. After the first submission, you can submit updates to your app and products for review independently of each other. </p>
<hr>
<h1 id="&#x63D0;&#x4EA4;&#x6D4B;&#x8BD5;"><a href="#&#x63D0;&#x4EA4;&#x6D4B;&#x8BD5;" class="headerlink" title="&#x63D0;&#x4EA4;&#x6D4B;&#x8BD5;"></a>&#x63D0;&#x4EA4;&#x6D4B;&#x8BD5;</h1><p>When validating receipts on your server, your server needs to be able to handle a production-signed app getting its receipts from Apple&#x2019;s test environment. The recommended approach is for your production server to always validate receipts against the production App Store first. If validation fails with the error code &#x201C;Sandbox receipt used in production&#x201D;, validate against the test environment instead. </p>
<hr>
<h1 id="&#x9A8C;&#x8BC1;receipt"><a href="#&#x9A8C;&#x8BC1;receipt" class="headerlink" title="&#x9A8C;&#x8BC1;receipt"></a>&#x9A8C;&#x8BC1;receipt</h1><p>Perform receipt validation immediately after your app is launched, before displaying any user interface or spawning any child processes. Implement this check in the main function, before the NSApplicationMain function is called. For additional security, you may repeat this check periodically while your application is running. </p>
<hr>
<h1 id="receipt&#x7684;&#x9A8C;&#x8BC1;&#x54CD;&#x5E94;"><a href="#receipt&#x7684;&#x9A8C;&#x8BC1;&#x54CD;&#x5E94;" class="headerlink" title="receipt&#x7684;&#x9A8C;&#x8BC1;&#x54CD;&#x5E94;"></a>receipt&#x7684;&#x9A8C;&#x8BC1;&#x54CD;&#x5E94;</h1><p>The receipt field on the JSON object holds the parsed information from the receipt. The receipt data for an auto-renewable subscription includes some additional keys, and some other keys are used differently for subscriptions. For information about keys found in a receipt, see &#x201C;Receipt Fields.&#x201D;<br>In addition to the receipt field, the response may also include two other fields. If the user&#x2019;s subscription is active and was renewed by a transaction that took place after the receipt your server sent to the App Store, the latest_receipt field includes a base-64 encoded receipt for the last renewal for this subscription. The decoded data for this new receipt is also provided in the latest_expired_receipt_info field. Your server can use this new receipt to maintain a record of the most recent renewal.</p>
<hr>
<h1 id="&#x51E0;&#x4E2A;&#x5173;&#x952E;&#x7684;receipt&#x9A8C;&#x8BC1;&#x54CD;&#x5E94;&#x5B57;&#x6BB5;"><a href="#&#x51E0;&#x4E2A;&#x5173;&#x952E;&#x7684;receipt&#x9A8C;&#x8BC1;&#x54CD;&#x5E94;&#x5B57;&#x6BB5;" class="headerlink" title="&#x51E0;&#x4E2A;&#x5173;&#x952E;&#x7684;receipt&#x9A8C;&#x8BC1;&#x54CD;&#x5E94;&#x5B57;&#x6BB5;"></a>&#x51E0;&#x4E2A;&#x5173;&#x952E;&#x7684;receipt&#x9A8C;&#x8BC1;&#x54CD;&#x5E94;&#x5B57;&#x6BB5;</h1><p>Receipt Expiration Date<br>The date that the app receipt expires.<br>ASN.1 Field Type 21<br>ASN.1 Field Value IA5STRING, interpreted as an RFC 3339 date<br>JSON Field Name expiration_date<br>JSON Field Value IA5STRING, interpreted as an RFC 3339 date<br>This key is present only for apps purchased through the Volume Purchase Program. If this key is not present, the receipt does not expire.<br>When validating a receipt, compare this date to the current date to determine whether the receipt is expired. Do not try to use this date to calculate any other information, such as the time remaining before expiration. </p>
<p>Original Transaction Identifier<br>For a transaction that restores a previous transaction, the transaction identifier of the original transaction. Otherwise, identical to the transaction identifier.<br>ASN.1 Field Type 1705<br>ASN.1 Field Value UTF8STRING<br>JSON Field Name original_transaction_id<br>JSON Field Value string<br>This value corresponds to the original transaction&#x2019;s transactionIdentifier property.<br>All receipts in a chain of renewals for an auto-renewable subscription have the same value for this field. </p>
<p>Purchase Date<br>The date and time that the item was purchased.<br>ASN.1 Field Type 1704<br>ASN.1 Field Value IA5STRING, interpreted as an RFC 3339 date<br>JSON Field Name purchase_date<br>JSON Field Value string, interpreted as an RFC 3339 date<br>This value corresponds to the transaction&#x2019;s transactionDate property.<br>For a transaction that restores a previous transaction, the purchase date is the date of the restoration. Use &#x201C;Original Purchase Date&#x201D; to get the date of the original transaction.<br>In an auto-renewable subscription receipt, this is always the date when the subscription was purchased or renewed, regardless of whether the transaction has been restored. </p>
<p>Original Purchase Date<br>For a transaction that restores a previous transaction, the date of the original transaction.<br>ASN.1 Field Type 1706<br>ASN.1 Field Value IA5STRING, interpreted as an RFC 3339 date<br>JSON Field Name original_purchase_date<br>JSON Field Value string, interpreted as an RFC 3339 date<br>This value corresponds to the original transaction&#x2019;s transactionDate property.<br>In an auto-renewable subscription receipt, this indicates the beginning of the subscription period, even if the subscription has been renewed.</p>
<p>Subscription Expiration Date<br>The expiration date for the subscription, expressed as the number of milliseconds since January 1, 1970, 00:00:00 GMT.<br>ASN.1 Field Type 1708<br>ASN.1 Field Value IA5STRING, interpreted as an RFC 3339 date<br>JSON Field Name expires_date<br>JSON Field Value number<br>This key is only present for auto-renewable subscription receipts.</p>

                        
                    </div>

                    
                    
                    

                    <div class="description post-description">
    <span class="post-description-item">
        <time datetime="2014-01-09T07:47:10.000Z" itemprop="datePublished">2014-01-09</time>

    </span>
    <span class="post-description-item">
        

    <span>
        <i class="tags icon"></i>
    </span>

    
    <span class="ui tiny label">
        <a href="/tags/In-App-Purcharse/">In-App-Purcharse</a>
    </span>

    

    </span>
</div>

                </div>
                
                <div id="pagination" class="nav-web ui text container pagination">

    <div class="ui stackable two column divided grid container">
        <div class="row">
            <div class="column nav-left">
                

                <a href="/2014/04/24/设计模式-一句话版/" class="ui tiny button">

                    <i class="angle left icon"></i>
                    
                    设计模式-一句话版
                    

                </a>

                
            </div>
            <div class="column nav-right">
                

                <a href="/2011/10/03/Jobs-必须找到你所钟爱的东西/" class="ui tiny button">
                    
                    Jobs-必须找到你所钟爱的东西
                    
                    <i class="angle right icon"></i></a>
                
            </div>
        </div>
    </div>

</div>
                
            </div>

            
            <div class="three wide computer three wide tablet column">

                <div class="ui sticky article-toc" id="article-toc">
                    <!-- toc -->
                    <ol class="ui ordered list"><li><a href="#购买信息标识"><span>购买信息标识</span></a></li><li><a href="#结束购买"><span>结束购买</span></a></li><li><a href="#不要这样"><span>不要这样</span></a></li><li><a href="#订阅时间的计算"><span>订阅时间的计算</span></a></li><li><a href="#自动续订的策略"><span>自动续订的策略</span></a></li><li><a href="#取消订阅"><span>取消订阅</span></a></li><li><a href="#多平台购买"><span>多平台购买</span></a></li><li><a href="#自动续订测试"><span>自动续订测试</span></a></li><li><a href="#恢复购买验证"><span>恢复购买验证</span></a></li><li><a href="#恢复receipt"><span>恢复receipt</span></a></li><li><a href="#restore"><span>restore</span></a></li><li><a href="#初次提交商品"><span>初次提交商品</span></a></li><li><a href="#提交测试"><span>提交测试</span></a></li><li><a href="#验证receipt"><span>验证receipt</span></a></li><li><a href="#receipt的验证响应"><span>receipt的验证响应</span></a></li><li><a href="#几个关键的receipt验证响应字段"><span>几个关键的receipt验证响应字段</span></a></li></ol>
                </div>

            </div>
            

        </div>
    </div>
</div>



<!-- css -->
  <style type="text/css">
      .center {
          text-align: center;
      }
      .hidden {
          display: none;
      }
    .donate_bar a.btn_donate{
      display: inline-block;
      width: 82px;
      height: 82px;
      background: url("http://7xsl28.com1.z0.glb.clouddn.com/btn_reward.gif") no-repeat;
      _background: url("http://7xsl28.com1.z0.glb.clouddn.com/btn_reward.gif") no-repeat;
      <!-- http://img.t.sinajs.cn/t5/style/images/apps_PRF/e_media/btn_reward.gif
           因为本 hexo 生成的博客所用的 theme 的 a:hover 带动画效果，
         为了在让打赏按钮显示效果正常 而 添加了以下几行 css，
         嵌入其它博客时不一定要它们。 -->
      -webkit-transition: background 0s;
      -moz-transition: background 0s;
      -o-transition: background 0s;
      -ms-transition: background 0s;
      transition: background 0s;
      <!-- /让打赏按钮的效果显示正常 而 添加的几行 css 到此结束 -->
    }
    .donate_bar a.btn_donate:hover{ background-position: 0px -82px;}
    .donate_bar .donate_txt {
      display: block;
      color: #9d9d9d;
      font: 14px/2 "Microsoft Yahei";
    }
    .bold{ font-weight: bold; }
  </style>
<!-- /css -->
<!-- Donate Module -->
  <div id="donate_module">
  <!-- btn_donate & tips -->
    <div id="donate_board" class="donate_bar center">      
    <br>
    <a id="btn_donate" class="btn_donate" target="_self" href="javascript:;" title="Donate 打赏"></a>
    <span class="donate_txt">
      我知道不会有人打赏，可是万一有人想不开呢？
    </span>    
    </div>
  <!-- /btn_donate & tips -->
  <!-- donate guide -->
    <div id="donate_guide" class="donate_bar center hidden">
    <br>
      <a title="用微信扫一扫哦~" class="fancybox" rel="article0">
        <img src="/images/wechat_small.jpg" title="微信打赏 Joe" height="190px" width="auto"/>
      </a>&nbsp;&nbsp;
      <!-- 暂时不需要支付宝，只用微信支付就好了
      <a href="/images/alipay_small.jpg" title="用支付宝扫一扫即可~" class="fancybox" rel="article0">
        <img src="/images/alipay_small.jpg" title="支付宝打赏 Joe" height="190px" width="auto"/>
      </a>
      -->
      <span class="donate_txt">
        我知道不会有人打赏，可是万一有人想不开呢？
      </span>
    </div>
  <!-- /donate guide -->
<!-- donate script -->
  <script type="text/javascript">
    document.getElementById('btn_donate').onclick = function() {
      $('#donate_board').addClass('hidden');
      $('#donate_guide').removeClass('hidden');
    }
    function donate_on_web(){
      $('#donate').submit();
        }
    var original_window_onload = window.onload;
        window.onload = function () {
            if (original_window_onload) {
                original_window_onload();
            }
            //document.getElementById('donate_board_wdg').className = 'hidden';
    }
  </script>
<!-- /donate script -->
</div>
<!-- /Donate Module -->




<!-- duoshuo start -->
<div class="ds-thread" data-thread-key="2014/01/09/In-App-Purcharse 摘要/" data-title="In-App-Purcharse 摘要 | Joe&#39;s Doc" data-url="http://yoursite.com/2014/01/09/In-App-Purcharse 摘要/"></div>
<!-- 多说评论框 end -->
<!-- 多说公共JS代码 start (一个网页只需插入一次) -->
<script type="text/javascript">
    var duoshuoQuery = {short_name:"joegithubio"};
    (function() {
        var ds = document.createElement('script');
        ds.type = 'text/javascript';ds.async = true;
        ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
        ds.charset = 'UTF-8';
        (document.getElementsByTagName('head')[0]
        || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
</script>
<!-- duoshuo end -->

                    <!--</div>-->
                <!--</div>-->
            <!--</div>-->
        </div>
        <div class="ui vertical footer segment">
    <div class="ui center aligned container">
        <div class="ui inverted section divider"></div>
        &copy; 2017 <a href="/">Joe Lee</a>,
        Powered by <a href="https://github.com/henryhuang/hexo-theme-aloha" target="_blank">Aloha</a> and <a
                href="http://hexo.io/" target="_blank">Hexo</a>.
    </div>
</div>

    </div>




<!-- scripts list from theme config.yml -->

<script src="//cdn.bootcss.com/jquery/3.1.0/jquery.min.js"></script>

<script src="//cdn.bootcss.com/semantic-ui/2.2.4/semantic.min.js"></script>

<script src="//cdn.bootcss.com/algoliasearch/3.18.1/algoliasearch.min.js"></script>

<script src="//cdn.bootcss.com/algoliasearch-helper-js/2.13.0/algoliasearch.helper.min.js"></script>

<script src="/js/semantic-ui-algolia.js"></script>

<script src="/js/aloha-events.js"></script>



</body>
</html>
